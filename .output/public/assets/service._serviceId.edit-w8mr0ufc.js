import{o as z,u as J,b as Z,a as L,r as a,d as ee,j as e}from"./index-5PltJSx_.js";import{a as b}from"./api-Df4qyv35.js";import{X as U,I as se,S as te}from"./ImageUpload-Zk7bMy51.js";import{A as ae}from"./arrow-left-C7m3PQ5f.js";import{P as _}from"./plus-BlFsALoN.js";function ce(){const{serviceId:W}=z.useParams(),{userId:B}=J(),j=Z(),N=L(b.users.getCurrentUser,{clerkId:B??""}),t=L(b.services.getService,{serviceId:W}),[m,S]=a.useState(""),[x,w]=a.useState(""),[p,C]=a.useState(""),[g,k]=a.useState(""),[h,I]=a.useState(""),[r,v]=a.useState([]),[i,A]=a.useState(""),[n,f]=a.useState([]),[l,P]=a.useState(""),[o,T]=a.useState(""),[c,D]=a.useState(""),[E,M]=a.useState([]),[q,$]=a.useState(!0),[H,R]=a.useState(!1),[y,d]=a.useState(""),G=ee(b.services.updateService),K=["Photography","Videography","Music & Audio","Event Planning","Catering","Cleaning","Moving","Personal Training","Tutoring","Web Design","Graphic Design","Writing","Translation","Social Media","Consulting","Other"],O=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];if(a.useEffect(()=>{t&&(S(t.title),w(t.description),C(t.category),k(t.pricePerHour.toString()),I(t.location),v(t.tags),f(t.availability),M(t.images),$(t.isActive))},[t]),!t)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-3xl mx-auto text-center",children:e.jsx("p",{children:"Loading service..."})})});if(!N||N._id!==t.userId)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-3xl mx-auto text-center",children:e.jsx("p",{children:"You can only edit your own services."})})});const F=()=>{i.trim()&&!r.includes(i.trim())&&(v([...r,i.trim()]),A(""))},Q=s=>{v(r.filter(u=>u!==s))},V=()=>{if(l&&o&&c){const s=`${l} ${o}-${c}`;f([...n,s]),P(""),T(""),D("")}},X=s=>{f(n.filter(u=>u!==s))},Y=async s=>{if(s.preventDefault(),!m||!x||!p||!g||!h){d("Please fill in all required fields");return}R(!0),d("");try{await G({serviceId:t._id,title:m,description:x,category:p,pricePerHour:parseFloat(g),availability:n,location:h,tags:r,images:E,isActive:q}),d("Service updated successfully!"),setTimeout(()=>{j.navigate({to:"/service/$serviceId",params:{serviceId:t._id}})},1500)}catch{d("Failed to update service. Please try again.")}finally{R(!1)}};return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>j.navigate({to:"/service/$serviceId",params:{serviceId:t._id}}),className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(ae,{className:"h-5 w-5"}),"Back to Service"]})}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Edit Service"}),e.jsxs("form",{onSubmit:Y,className:"bg-card border rounded-lg p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Service Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:m,onChange:s=>S(s.target.value),className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"E.g., Professional Photography",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:x,onChange:s=>w(s.target.value),className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary min-h-[150px]",placeholder:"Describe your service in detail...",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:p,onChange:s=>C(s.target.value),className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),K.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Price per Hour (â‚±) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:g,onChange:s=>k(s.target.value),min:"0",step:"0.01",className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Location ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:h,onChange:s=>I(s.target.value),className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"City, Province",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tags"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:i,onChange:s=>A(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),F()),className:"flex-1 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Add a tag..."}),e.jsx("button",{type:"button",onClick:F,className:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors",children:e.jsx(_,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(s=>e.jsxs("span",{className:"bg-primary/10 text-primary px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[s,e.jsx("button",{type:"button",onClick:()=>Q(s),className:"hover:text-red-500",children:e.jsx(U,{className:"h-3 w-3"})})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Availability"}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-2 mb-3",children:[e.jsxs("select",{value:l,onChange:s=>P(s.target.value),className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select day"}),O.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("input",{type:"time",value:o,onChange:s=>T(s.target.value),className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("input",{type:"time",value:c,onChange:s=>D(s.target.value),className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("button",{type:"button",onClick:V,disabled:!l||!o||!c,className:"w-full sm:w-auto bg-muted px-4 py-2 rounded-md hover:bg-muted/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(_,{className:"h-4 w-4 inline mr-2"}),"Add Availability"]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:n.map(s=>e.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[s,e.jsx("button",{type:"button",onClick:()=>X(s),className:"hover:text-red-600",children:e.jsx(U,{className:"h-3 w-3"})})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Service Images"}),e.jsx(se,{maxImages:5,onImagesChange:M,defaultImages:E})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:q,onChange:s=>$(s.target.checked),className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm",children:"Make this service active and visible to others"})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("button",{type:"submit",disabled:H,className:"w-full bg-primary text-primary-foreground px-4 py-3 rounded-md font-medium hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),H?"Saving...":"Save Changes"]}),y&&e.jsx("p",{className:`mt-2 text-sm text-center ${y.includes("success")?"text-green-600":"text-red-600"}`,children:y})]})]})]})})}export{ce as component};
