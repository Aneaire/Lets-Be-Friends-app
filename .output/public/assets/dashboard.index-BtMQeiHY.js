import{u,d,r as x,a as m,j as e,f as v,e as N,L as b}from"./index-5PltJSx_.js";import{B as l}from"./button-BQAKe5sM.js";import{a}from"./api-Df4qyv35.js";import{w}from"./auth-BhrcrAHN.js";const y=()=>{const{userId:s,isSignedIn:i}=u(),o=d(a.users.createUser);x.useEffect(()=>{i&&s!==null&&s!==void 0&&o({clerkId:s,email:"",fullName:"User"})},[i,s,o])};function C(){const[s,i]=x.useState(""),{userId:o}=u();y();const t=m(a.posts.listPosts,{}),n=m(a.users.getCurrentUser,{clerkId:o??""}),c=d(a.posts.createPost),h=d(a.posts.toggleLike),g=d(a.posts.savePost),f=async()=>{!n||!s.trim()||(await c({userId:n._id,caption:s,images:[],tags:[]}),i(""))},j=r=>{n&&h({userId:n._id,postId:r})},p=r=>{n&&g({userId:n._id,postId:r})};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(v,{children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Home"}),e.jsx("textarea",{value:s,onChange:r=>i(r.target.value),placeholder:"What's on your mind?",className:"w-full p-4 border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary",rows:3}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(l,{onClick:()=>{f()},disabled:!s.trim(),children:"Post"})})]}),e.jsx("div",{className:"space-y-6",children:t===void 0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Loading posts..."}):t.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No posts yet. Be the first to share something!"}):t.map(r=>e.jsx(k,{post:r,onLike:j,onSave:p},r._id))})]})}),e.jsx(N,{children:e.jsxs("div",{className:"max-w-md mx-auto text-center py-16",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Welcome to Let's Be Friends"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"A social marketplace platform for connecting people and building meaningful friendships"}),e.jsx(b,{to:"/auth/sign-in",children:e.jsx(l,{size:"lg",children:"Sign In to Continue"})})]})})]})}function k({post:s,onLike:i,onSave:o}){const t=m(a.users.getUser,{userId:s.userId});return e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:t?e.jsxs(e.Fragment,{children:[t.avatarUrl?e.jsx("img",{src:t.avatarUrl,alt:t.fullName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center text-white font-semibold",children:t.fullName.substring(0,2)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t.fullName}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.username&&`@${t.username}`})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center text-white font-semibold",children:s.userId.substring(0,2)}),e.jsx("div",{children:e.jsx("div",{className:"font-semibold",children:"Loading..."})})]})}),e.jsx("p",{className:"mb-4 whitespace-pre-wrap",children:s.caption}),s.images.length>0&&e.jsx("div",{className:"mb-4 grid gap-2",children:s.images.map((n,c)=>e.jsx("img",{src:`/api/storage/${n}`,alt:"",className:"rounded-lg w-full"},c))}),e.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t",children:[e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>i(s._id),children:[s.likesCount," ",s.likesCount===1?"Like":"Likes"]}),e.jsxs(l,{variant:"ghost",size:"sm",children:[s.commentsCount," ",s.commentsCount===1?"Comment":"Comments"]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>o(s._id),children:"Save"})]})]})}const P=w(C);export{P as component};
