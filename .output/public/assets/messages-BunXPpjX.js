import{c,u as m,a as d,j as e,r as x,L as u}from"./index-5PltJSx_.js";import{a as l}from"./api-Df4qyv35.js";import{w as h}from"./auth-BhrcrAHN.js";import{E as p}from"./ellipsis-vertical-D_ARX9Ke.js";const f=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],g=c("trash-2",f);function j(){const{userId:s}=m(),r=d(l.users.getCurrentUser,{clerkId:s??""}),t=d(l.messages.listConversations,{userId:r?._id??""});return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Messages"}),e.jsx("div",{className:"space-y-2",children:!t||t.length===0?e.jsxs("div",{className:"bg-card border rounded-lg p-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"No conversations yet."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Start a conversation from a profile or service page."})]}):t.map(a=>e.jsx(v,{conversation:a,currentUserId:r?._id??""},a._id))})]})})}function v({conversation:s,currentUserId:r}){const[t,a]=x.useState(!1),i=s.participants.find(n=>n!==r),o=s.lastMessageAt?new Date(s.lastMessageAt).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):null;return e.jsx(u,{to:"/messages/$conversationId",params:{conversationId:s._id},className:"block bg-card border rounded-lg p-4 hover:border-primary/50 transition-colors relative",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 flex items-start gap-3 min-w-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary flex items-center justify-center text-white font-semibold flex-shrink-0",children:i?.substring(0,2)??"??"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("h3",{className:"font-semibold truncate",children:["User ",i?.substring(0,8)]}),o&&e.jsx("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:o})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.lastMessage||"No messages yet"})]})]}),e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("button",{onClick:n=>{n.preventDefault(),a(!t)},className:"p-2 hover:bg-muted rounded-md",children:e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})}),t&&e.jsx("div",{className:"absolute right-0 top-8 bg-card border rounded-md shadow-lg p-1 min-w-[120px] z-10",children:e.jsxs("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-muted rounded text-red-600 flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4"}),"Delete"]})})]})]})})}const k=h(j);export{k as component};
