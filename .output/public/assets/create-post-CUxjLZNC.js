import{u as w,b as k,a as P,r as t,d as A,j as e}from"./index-5PltJSx_.js";import{a as y}from"./api-Df4qyv35.js";import{X as T,I as M,S as E}from"./ImageUpload-Zk7bMy51.js";import{A as U}from"./arrow-left-C7m3PQ5f.js";import{M as D}from"./map-pin-DKGBZGve.js";function K(){const{userId:i}=w(),c=k(),d=P(y.users.getCurrentUser,{clerkId:i??""}),[n,j]=t.useState(""),[m,v]=t.useState(""),[a,u]=t.useState([]),[o,p]=t.useState(""),[x,N]=t.useState([]),[g,f]=t.useState(!1),[l,r]=t.useState(""),C=A(y.posts.createPost),h=()=>{o.trim()&&!a.includes(o.trim())&&(u([...a,o.trim()]),p(""))},I=s=>{u(a.filter(b=>b!==s))},S=async s=>{if(s.preventDefault(),!i||!d){r("Please log in to create a post");return}if(!n){r("Please add a caption");return}f(!0),r("");try{await C({userId:d._id,caption:n,images:x,tags:a,location:m||void 0}),r("Post created successfully!"),setTimeout(()=>{c.navigate({to:"/dashboard"})},1500)}catch{r("Failed to create post. Please try again.")}finally{f(!1)}};return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>c.navigate({to:"/dashboard"}),className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(U,{className:"h-5 w-5"}),"Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create a Post"}),e.jsxs("form",{onSubmit:S,className:"bg-card border rounded-lg p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Caption ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:n,onChange:s=>j(s.target.value),className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary min-h-[150px]",placeholder:"What's on your mind?",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Location (optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"text",value:m,onChange:s=>v(s.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Add a location..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tags"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:o,onChange:s=>p(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),h()),className:"flex-1 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Add a tag (press Enter)..."}),e.jsx("button",{type:"button",onClick:h,className:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(s=>e.jsxs("span",{className:"bg-primary/10 text-primary px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[s,e.jsx("button",{type:"button",onClick:()=>I(s),className:"hover:text-red-500",children:e.jsx(T,{className:"h-3 w-3"})})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Images"}),e.jsx(M,{maxImages:5,onImagesChange:N,defaultImages:x})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("button",{type:"submit",disabled:g,className:"w-full bg-primary text-primary-foreground px-4 py-3 rounded-md font-medium hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),g?"Creating...":"Create Post"]}),l&&e.jsx("p",{className:`mt-2 text-sm text-center ${l.includes("success")?"text-green-600":"text-red-600"}`,children:l})]})]})]})})}export{K as component};
